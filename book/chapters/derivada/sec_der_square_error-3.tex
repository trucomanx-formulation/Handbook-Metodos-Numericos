
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Derivada de $||\MATRIX{A}\VECTOR{x}-\VECTOR{b}||_{\MATRIX{C}}^2$ 
}

\begin{theorem}\label{theo:derAxbAxb}
Se 
$\VECTOR{x}\in \mathbb{R}^N$ é um vetor coluna com elementos $x_n$, de modo que
$n\in \mathbb{N}$, $1 \leq n \leq N$, 
$\VECTOR{b}\in \mathbb{R}^M$ é um vetor coluna com elementos $b_m$, de modo que
$m\in \mathbb{N}$, $1 \leq m \leq M$,  
$\MATRIX{A} \in \mathbb{R}^{M\times N}$ é uma matriz com elementos $a_{mn}$, e
$\MATRIX{C} \in \mathbb{R}^{M\times M}$ é uma matriz diagonal, 
então se cumpre\footnote{A demonstração pode ser vista na Prova \ref{proof:theo:derAxbAxb}.} que:
\begin{equation}
\begin{matrix}
\frac{\partial ||\MATRIX{A}\VECTOR{x}-\VECTOR{b}||_{\MATRIX{C}}^2}{\partial x_n}&=&
\frac{\partial \left(\MATRIX{A}\VECTOR{x}-\VECTOR{b}\right)^{\transpose}\MATRIX{C}\left(\MATRIX{A}\VECTOR{x}-\VECTOR{b}\right)}{\partial x_n}&=&
2\left(\MATRIX{A}\VECTOR{x}-\VECTOR{b}\right)^{\transpose}\MATRIX{C}a_{:n}\\
~&~&~&=& 2\left(a_{:n}\right)^{\transpose}\MATRIX{C}\left(\MATRIX{A}\VECTOR{x}-  \VECTOR{b}\right)
\end{matrix}
\end{equation}
\end{theorem}

\begin{corollary}[Derivada de 
$||\MATRIX{A}\VECTOR{x}-\VECTOR{b}||_{\MATRIX{C}}^2$ em 
relação ao vetor $\VECTOR{x}^{\transpose}$:]\label{coro:derAxbAxb1}
Aplicando a Definição \ref{def:deltahor} junto ao Teorema \ref{theo:derAxbAxb}, é
fácil deduzir que:
\begin{equation}
\frac{\partial ||\MATRIX{A}\VECTOR{x}-\VECTOR{b}||_{\MATRIX{C}}^2}{\partial \VECTOR{x}^{\transpose}}=
2\left(\MATRIX{A}\VECTOR{x}- \VECTOR{b} \right)^{\transpose}\MATRIX{C}\MATRIX{A}
\end{equation}
\end{corollary}

\begin{corollary}[Derivada de 
$||\MATRIX{A}\VECTOR{x}-\VECTOR{b}||_{\MATRIX{C}}^2$ em 
relação ao vetor $\VECTOR{x}$:]\label{coro:derAxbAxb2}
Aplicando a Definição \ref{def:deltaver} junto ao Teorema \ref{theo:derAxbAxb}, é
fácil deduzir que:
\begin{equation}
\frac{\partial ||\MATRIX{A}\VECTOR{x}-\VECTOR{b}||_{\MATRIX{C}}^2}{\partial \VECTOR{x} }=
2 \MATRIX{A}^{\transpose}\MATRIX{C}\left(\MATRIX{A}\VECTOR{x}-\VECTOR{b}\right)
\end{equation}
\end{corollary}
